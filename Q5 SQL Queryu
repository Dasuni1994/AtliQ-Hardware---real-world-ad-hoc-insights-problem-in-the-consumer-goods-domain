Q5.Get the products that have the highest and lowest manufacturing costs. The final output should contain these fields,

product_code
product
manufacturing_cost


with 
cte01 as (select product_code ,max(manufacturing_cost) as manufacturing_cost_max ,min(manufacturing_cost) as manufacturing_cost_min  from fact_manufacturing_cost 
group by product_code),

cte02 as (
select m.product_code as product_code ,product , manufacturing_cost_max ,manufacturing_cost_min  from 
dim_product p join cte01 m 
on p.product_code = m.product_code
) ,

cte03 as 
(select product_code ,product , round(max(manufacturing_cost_max),2) as manufacturing_cost from cte02
GROUP BY product_code, product
order by manufacturing_cost desc
limit 1),

cte04 as 
(select product_code ,product , round(min(manufacturing_cost_min),2) as manufacturing_cost from cte02
GROUP BY product_code, product
order by manufacturing_cost asc
limit 1)

select * from cte03
union all	
select * from cte04
;
